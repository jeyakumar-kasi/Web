//var   menuList = {
//    '9': {
//        'label': 'Services',
//        'link': '/services',
//        'icon': 'fa-star',
//        'color': '#6f67ab',
//        'count': '2300',
//        'children': {
//            '89': {
//                'label': 'Man Looking for long term relationship',
//                'link': './category.shtml',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '91': {
//                'label': 'Big Cats for a long period is running for what.',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '11': {
//                'label': 'Looking for Jobs',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '10': {
//                'label': 'Welcome my friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '1': {
//                'label': 'Missing friend',
//                'link': './category.shtml',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '12': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '13': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '14': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '15': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '16': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '17': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            }
//
//        }
//    },
//
//
//
//    '2': {
//        'label': 'Personals',
//        'link': '/personals',
//        'icon': 'fa-heart',
//        'color': '#f33',
//        'count': '11000',
//        'children': {
//            '94': {
//                'label': 'Women looking',
//                'link': '/personals/women-looking',
//                'icon': 'fa-home',
//            },
//            '98': {
//                'label': 'Friends',
//                'link': '/personals/friends',
//                'icon': 'fa-home',
//            },
//            '82': {
//                'label': 'Children',
//                'link': '/personals/children',
//            }
//        }
//    },
//    '7': {
//        'label': 'Jobs',
//        'link': '/jobs',
//        'icon': 'fa-heartbeat',
//        'color': '#e91e63',
//        'count': '2300',
//        'children': {}
//    },
//
//    '70': {
//        'label': 'Vechiles',
//        'link': '/dating',
//        'icon': 'fa-heartbeat',
//        'color': '#e91e63',
//        'count': '2300',
//        'children': {}
//    },
//
//    '71': {
//        'label': 'Electronics',
//        'link': '/dating',
//        'icon': 'fa-heartbeat',
//        'color': '#e91e63',
//        'count': '2300',
//        'children': {}
//    },
//
//    '72': {
//        'label': 'Furnitures',
//        'link': '/dating',
//        'icon': 'fa-heartbeat',
//        'color': '#e91e63',
//        'count': '2300',
//        'children': {}
//    },
//
//    '73': {
//        'label': 'Properties',
//        'link': '/dating',
//        'icon': 'fa-heartbeat',
//        'color': '#e91e63',
//        'count': '2300',
//        'children': {}
//    },
//
//    '74': {
//        'label': 'Education',
//        'link': '/dating',
//        'icon': 'fa-heartbeat',
//        'color': '#e91e63',
//        'count': '2300',
//        'children': {}
//    },
//
//
//    '75': {
//        'label': 'Pets',
//        'link': '/dating',
//        'icon': 'fa-heartbeat',
//        'color': '#e91e63',
//        'count': '2300',
//        'children': {}
//    },
//
//    '19': {
//        'label': 'Events',
//        'link': '/events',
//        'icon': 'fa-star',
//        'color': '#6f67ab',
//        'count': '2300',
//        'children': {
//            '89': {
//                'label': 'Man Looking for long term relationship',
//                'link': '/services/man-looking-for-long-term',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '91': {
//                'label': 'Big Cats for a long period is running for what.',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '11': {
//                'label': 'Looking for Jobs',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//          '111': {
//                'label': 'Looking for Events',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2300',
//            },
//            '10': {
//                'label': 'Welcome my friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2,300',
//            },
//            '1': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '100',
//            },
//            '12': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '2,300',
//            },
//            '13': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '13',
//            },
//            '14': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '230',
//            },
//            '15': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '3',
//            },
//            '16': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '90',
//            },
//            '17': {
//                'label': 'Missing friend',
//                'link': '/services/big-cats',
//                'icon': 'fa-home',
//                'color': '#6f67ab',
//                'count': '1,800',
//            }
//
//        }
//    },
//
//    '77': {
//        'label': 'Others',
//        'link': '/dating',
//        'icon': 'fa-heartbeat',
//        'color': '#e91e63',
//        'count': '2300',
//        'children': {}
//    },
//
//    '78': {
//        'label': 'More',
//        'link': '/dating',
//        'icon': 'fa-ellipsis-h',
//        'color': '#e91e63',
//        'count': '2300',
//        'children': {}
//    }
//}

$(function() {
    /*if ($('#category').length > 0) {
        // Set list of categories.
        var html = '<option value="">-- All --</option>';
        Object.keys(menuList).map(function(k, v) {
            html += '<option value="'+ menuList[k]['_id'] +'">'+ menuList[k]['label'] +'</option>';
        });
        $('#category').html(html);
    }*/
    
    // Create a menu bar
    var html = '<div class="row">';
    var moreId = 11; //1000;
    Object.keys(menuList).map(function(k, v) {
        var item = menuList[k];
        if (k <= 11){
            if (k == 11) {
                // More menu
                var item = {
                    '_id' : moreId,
                    'icon': 'fa-ellipsis-h',
                    'label': 'More'
                }

                menuList[moreId] = {
                    'children': [menuList[k]]
                };
            }
            html += '<div class="grid-item" data-idx="'+ k +'" data-id="'+ item._id +'">';
            html +=      '<i class="fa '+ item.icon +'" style="color: '+ item.color +'"></i><br />'; // 
            html +=      '<span>'+ item.label +'</span>';
            html += '</div>';
        } else {
            // Add to 'more' menu.
            menuList[moreId]['children'].push(item);
        }   
    });
    html += '</div>';
    $('#categories-grid').html(html);

    

    $('#categories-grid .grid-item').on('click', function() {
        var $this  = $(this)
        ,   isAlreadyActive = $this.hasClass('active');

        var $actMenu = $('#categories-grid .grid-item.active');
        $actMenu.removeClass('active');

        if (! isAlreadyActive) {
            var menuIdx = $this.attr('data-idx') || null
            ,   menu   = menuList[menuIdx];
            
            if (menuIdx != null && $('#menu-list-'+ menuIdx).length == 0) {
                var childLen= Object.keys(menu['children']).length
                ,   html    = '<div class="'+ (!IS_MD_DVC ? 'row' : 'container') +' grid-sub-list" id="menu-list-'+ menuIdx +'">';

                if (childLen > 0) {
                    // Children are there!
                    var i = 0
                    ,   clmCount  = Math.ceil(childLen / 3);
                    html += '<div class="row">';
                    html +=   '<div class="col-md-4">';
                    Object.keys(menu['children']).map(function(k, v) {
                          var child = menu['children'][k]
                          ,   icon  = typeof menu['icon'] == 'undefined' ? child['icon'] : 'fa fa-angle-right'; //menu['icon'];
                          
                          html += '<div class="sub-list-item">';
                          html +=     '<i class="fa '+ icon +'"></i>';
                          html +=     '<a href="'+ child['link'] +'">'+ child['label'];
                          if (child['count'] > 0) {
                                html += '<small class="small-text"> ('+ child['count'] +')</small>';
                          }
                          html +=     '</a>';
                          html += '</div>';

                          html +=  ! IS_MD_DVC && ++i % clmCount == 0 ? '</div><div class="col-md-4">' : '';
                    });
                    html +=   '</div>'; // .col-md-3
                    html += '</div>'; // .row
                } else {
                    html += '<div class="no-results">No items found.</div>';
                }

                html += '<div class="demo-icon">'+ (typeof menu['label'] != 'undefined' ? menu['label'] : 'More') + '</div>';
                html += '</div>';

                // For smaller screen append immediately next to particular active grid item.
                var $appendEle = ! IS_MD_DVC ? $this.parent() : $this;
                $appendEle.after(html);
            } // isAlreadyActive

            $this.addClass('active');
            $('#menu-list-'+ menuIdx).addClass('actve').fadeIn(1200);//'slow', function() {
            window.setTimeout(function(){
                //if (! $('#menu-list-'+ menuIdx).is(':visible')) {//$('#categories-grid').hasClass('scrolled')) {
                    scrollTo(IS_MD_DVC ? '#categories-grid .grid-item.active' : '#categories-grid', 500);
                    //$('#categories-grid').addClass('scrolled');
                //}
            }, 300);
        }

        // Hide prev. actived one.
        $('#menu-list-' + $actMenu.attr('data-idx')).fadeOut(IS_MD_DVC ? 1000 : 0);//'slow');
    });
});
